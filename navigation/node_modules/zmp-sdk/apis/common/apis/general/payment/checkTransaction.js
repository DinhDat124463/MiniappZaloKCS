import r from'./../../../../external/@swc/helpers/src/_async_to_generator.mjs.js';import e from"../../../token.js";import t from"../../../../utils/query-string.js";import{apiResponse as s}from"../../../../utils/response.js";import{PAYMENT_APIS as a,APP_ID as o}from"../../../../constants.js";import n from"../getRouteParams.js";import{__generator as i}from'./../../../../external/tslib/tslib.es6.js';var d,c=(d=r((function(r){var d,c,m,p,u,h,f,g,l,j,I;return i(this,(function(i){switch(i.label){case 0:return c="",r||(r=n()),"object"==typeof r&&((c=r.zmpOrderId||"")||(d=r.appTransID||r.orderId||r.apptransid)),"string"==typeof r&&(m=t.getParameterByName("orderId",r),p=t.getParameterByName("appTransID",r)||t.getParameterByName("apptransid",r),d=m||p),u={headers:{authorization:"Bearer "}},[4,e.getAccessToken().catch((function(){throw s.error.loginRequired}))];case 1:return h=i.sent(),u.headers.authorization="Bearer ".concat(h),f=new URL(a.GET_TRANSACTION),g={orderId:c,transId:d||"",appId:o},f.search=new URLSearchParams(g).toString(),[4,fetch(f.toString(),u)];case 2:return[4,i.sent().json()];case 3:if(!(l=i.sent()).data)throw s.error.badRequest(l.msg);return j=l.data||{},I={err:l.err},0!==Object.keys(j).length&&j.constructor===Object&&Object.assign(I,{msg:j.resultMessage,orderId:j.orderId,resultCode:j.resultCode,transTime:j.transTime,createdAt:j.createAt,transId:j.transId,path:j.path}),[2,I]}}))})),function(r){return d.apply(this,arguments)});export{c as default};
